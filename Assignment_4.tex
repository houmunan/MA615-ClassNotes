/documentclass[a4paper]{article}

/title{Assignment 4}
/author{Munan Hou}

/begin{document}
/SweaveOpts{concordance=TRUE}

/maketitle{}
1. CLT

I've searched the google and found 10+ tests. The tests that I familiar with are Kolmogorovâ€“Smirnov test, Pearson's chi-squared test, test of kurtosis and skewnessand, and shapiro-wilk test and qq plot.

So I am going to dig this on my own way. This is a little bit mess.

\begin{Schunk}
\begin{Sinput}
> library(ggplot2)
> library(nortest)
> library(normtest)
\end{Sinput}
\end{Schunk}

First, sample and summary that on average, for sums of how many uniform distribution could follow a normal distribution, on the significance level p=.05

\begin{Schunk}
\begin{Sinput}
> data1 <- c()
> number <- c()
> for (k in 1:100) {
+   for (i in 1:50) {
+     data1 <- c()
+     for (j in 1:1000) {
+       index <- runif(i)
+       sumindex <- sum(index)
+       data1[j] <- sumindex
+     }
+     if (shapiro.test(data1)["p.value"] > .05) {
+       number <- c(number,i);break
+     }
+   }
+ }
> number
\end{Sinput}
\begin{Soutput}
  [1] 4 3 3 4 4 4 3 5 5 3 6 5 3 3 5 4 3 4 4 4 5 4 5 4 3 5 4 4 3 4 4 4 5 3 4 5 4
 [38] 6 4 4 4 3 3 4 4 4 5 4 5 5 4 4 4 3 3 3 6 6 4 5 6 4 4 4 4 4 3 5 3 4 4 4 4 4
 [75] 6 4 4 3 3 4 5 4 3 5 4 6 3 5 3 3 4 4 3 3 4 5 4 6 5 3
\end{Soutput}
\begin{Sinput}
> mean(number)
\end{Sinput}
\begin{Soutput}
[1] 4.09
\end{Soutput}
\end{Schunk}

Result shows, on average, the mean of "the sum of minimum amount of uniform distributions" which can construct a normal distribution is approximately 4.

Then test Poisson distribution with lambda = 10.

\begin{Schunk}
\begin{Sinput}
> data1 <- c()
> number <- c()
> for (k in 1:100) {
+   for (i in 1:50) {
+     for (j in 1:1000) {
+       index <- rpois(i, lambda = 5)
+       sumindex <- sum(index)
+       data1[j] <- sumindex
+     }
+     if (shapiro.test(data1)["p.value"] > .05) {
+       number <- c(number,i);break
+     }
+   }
+ }
> number
\end{Sinput}
\begin{Soutput}
  [1] 14 14 13 15  9 12 11 13 15 12 12 10 13 13 13 15 13 13 10 12 14 16  9 12 13
 [26] 13 14 12 12 20 18 11 12 15 14 11  8 15 18 17 11 15 12 13 17 12 12 14 15 13
 [51] 11 18 14  8 13 11 11 12 13 14 17 11 17  9 20 10 10  9 14 16 13 17 13  9 11
 [76] 16 11 11 12 14 10  9 14 11 11 12 11 10 13 11 10 14 16 13 13 12 14 17 12 11
\end{Soutput}
\begin{Sinput}
> mean(number)
\end{Sinput}
\begin{Soutput}
[1] 12.89
\end{Soutput}
\end{Schunk}

Approximately 11 - 13 Poisson distributions.

Compare with uniform, Poisson converges more slowly.

/maketitle{}

2. Delta Method

Sampling Poisson(5)

\begin{Schunk}
\begin{Sinput}
> x <- rpois(1000, 5)
> data2 <- c()
> hist(x)
> for (j in 1:1000) {
+   index <- rpois(1000, 5)
+   data2 <- c(data2, mean(rpois(1000, 5)))
+   }
> y <- 1/data2
> qqnorm(y);qqline(y)
> shapiro.test(data2)
\end{Sinput}
\begin{Soutput}
	Shapiro-Wilk normality test

data:  data2
W = 0.99698, p-value = 0.05559
\end{Soutput}
\end{Schunk}

Test shows it follows normal dist.

3. Student's t-test

\begin{Schunk}
\begin{Sinput}
> x <- seq(-4, 4, length = 10000)
> normdist <- dnorm(x, mean = 0, sd = 1)
> tdist1df <- dt(x, df = 1)
> tdist10df <- dt(x, df = 10)
> tdist100df <- dt(x, df = 100)
> plot(x, normdist, type = "l")
> lines(x, tdist1df, col = 'red')
> lines(x, tdist10df, col = 'green')
> lines(x, tdist100df, col = 'blue')
\end{Sinput}
\end{Schunk}

Could easily see that, with higher d.f., a t-distribution are approaching the normal distribution.

4. Median, Mean Square Error, Bootstrap

\begin{Schunk}
\begin{Sinput}
> productsales <- read.delim("C:/YUKIHO/BU/MA 615/Assignments/6/productsales.dat")
> productsales <- as.numeric(as.matrix(productsales))
> median <- median(productsales)
> Tboot <- rep(0,10000)
> for (i in 1:10000){
+   rep = sample(productsales, length(productsales), replace = TRUE)
+   Tboot[i] = median(rep)
+   }
> median <- mean(Tboot)
> median
\end{Sinput}
\begin{Soutput}
[1] 90213.79
\end{Soutput}
\begin{Sinput}
> MSE <- sum((median - Tboot) ^ 2) / length(Tboot)
> MSE
\end{Sinput}
\begin{Soutput}
[1] 24752358
\end{Soutput}
\begin{Sinput}
> 
\end{Sinput}
\end{Schunk}

/end{document}
